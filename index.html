<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>浏览器手机版本验证t</title>
</head>
<body>
<script src="jquery-1.10.1.min.js"></script>
<script type="text/javascript" src="qrcode.js"></script>
<script>
  $(function() {
    var canvas = createCanvas();
    $("#qrcodeCanvas").append(canvas);
  });

  var createCanvas	= function(){
    var background = "#ffffff";
    var foreground = "#000000";

    var qrcode	= new QRCode(-1, QRErrorCorrectLevel.H);
    qrcode.addData("http://hiklyteam.github.io/phoneWebTest/testWebVersion.html");
    qrcode.make();

    // create canvas element
    var canvas	= document.createElement('canvas');
    canvas.width	= 580;
    canvas.height	= 580;
    var ctx		= canvas.getContext('2d');

    // 文字说明
    ctx.fillStyle = "#fff";
    ctx.fillRect(0,0,580,100);
    ctx.fillStyle = "#999999";
    ctx.font = "26px 黑体";
    ctx.textBaseline = 'top';
    //填充字符串
    var text="使用二维码或验证码校验浏览器版本情况";
    ctx.fillText(text, 26, 26);

    // compute tileW/tileH based on options.width/options.height
    var tileW	= 200  / qrcode.getModuleCount();
    var tileH	= 200 / qrcode.getModuleCount();

    // draw in the canvas
    for( var row = 0; row < qrcode.getModuleCount(); row++ ){
      for( var col = 0; col < qrcode.getModuleCount(); col++ ){
        ctx.fillStyle = qrcode.isDark(row, col) ? foreground : background;
        var w = (Math.ceil((col+1)*tileW) - Math.floor(col*tileW));
        var h = (Math.ceil((row+1)*tileW) - Math.floor(row*tileW));
        ctx.fillRect(190 + Math.round(col*tileW), 100 + Math.round(row*tileH), w, h);
      }
    }

    // return just built canvas
    return canvas;
  }

  CanvasRenderingContext2D.prototype.dashedLineTo = function (fromX, fromY, toX, toY, pattern) {
    // default interval distance -> 5px
    if (typeof pattern === "undefined") {
      pattern = 5;
    }

    // calculate the delta x and delta y
    var dx = (toX - fromX);
    var dy = (toY - fromY);
    var distance = Math.floor(Math.sqrt(dx*dx + dy*dy));
    var dashlineInteveral = (pattern <= 0) ? distance : (distance/pattern);
    var deltay = (dy/distance) * pattern;
    var deltax = (dx/distance) * pattern;

    // draw dash line
    this.beginPath();
    for(var dl=0; dl<dashlineInteveral; dl++) {
      if(dl%2) {
        this.lineTo(fromX + dl*deltax, fromY + dl*deltay);
      } else {
        this.moveTo(fromX + dl*deltax, fromY + dl*deltay);
      }
    }
    this.stroke();
  };
</script>

<div id="qrcodeCanvas"></div>
</body>
</html>